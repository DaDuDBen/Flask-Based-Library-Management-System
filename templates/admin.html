<!DOCTYPE html>
<html>
<head>
    <title>Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-4">

<div class="d-flex justify-content-between">
    <h2>Admin Dashboard</h2>
    <a href="/logout" class="btn btn-danger">Logout</a>
</div>

<form class="row mt-3" method="POST" action="/admin/add">
    <div class="col">
        <input class="form-control" name="title" placeholder="Title" required>
    </div>
    <div class="col">
        <input class="form-control" name="author" placeholder="Author" required>
    </div>
    <div class="col">
        <button class="btn btn-success w-100">Add Book</button>
    </div>
</form>

<h4 class="mt-4">Books</h4>
<table class="table table-striped">
<tr>
    <th>Title</th>
    <th>Author</th>
    <th>Status</th>
    <th>Borrowed By</th>
    <th>Action</th>
</tr>
{% for b in books %}
<tr>
    <td>{{ b.title }}</td>
    <td>{{ b.author }}</td>
    <td>{{ b.status }}</td>
    <td>{{ b.borrowed_by or "-" }}</td>
    <td>
        <a href="/admin/delete/{{ b.id }}" class="btn btn-danger btn-sm">Delete</a>
    </td>
</tr>
{% endfor %}
</table>

<h4 class="mt-5">Borrow History & Fines</h4>
<table class="table table-bordered">
<tr>
    <th>User</th>
    <th>Book</th>
    <th>Borrowed</th>
    <th>Due</th>
    <th>Returned</th>
    <th>Late</th>
    <th>Fine (â‚¹)</th>
</tr>
{% for h in history %}
<tr>
    <td>{{ h.user_id }}</td>
    <td>{{ h.book_id }}</td>
    <td>{{ h.borrow_date.strftime('%Y-%m-%d') }}</td>
    <td>{{ h.due_date.strftime('%Y-%m-%d') }}</td>
    <td>{{ h.return_date.strftime('%Y-%m-%d') if h.return_date else '-' }}</td>
    <td>
        {% if h.is_late %}
        <span class="badge bg-danger">Yes</span>
        {% else %}
        <span class="badge bg-success">No</span>
        {% endif %}
    </td>
    <td>{{ h.fine_amount }}</td>
</tr>
{% endfor %}
</table>

</div>
</body>
</html>
